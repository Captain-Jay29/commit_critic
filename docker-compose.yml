version: "3.9"

services:
  critic:
    build:
      context: .
      dockerfile: Dockerfile
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY}
    volumes:
      # Mount current directory for analyzing local repos
      - .:/workspace:ro
      # Persist memory database
      - critic-data:/home/critic/.commit-critic
    working_dir: /workspace

volumes:
  critic-data:
